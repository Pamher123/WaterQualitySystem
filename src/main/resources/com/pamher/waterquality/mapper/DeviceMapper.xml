<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pamher.waterquality.mapper.DeviceMapper">

    <!-- 查询所有设备 -->
    <select id="findAllDevices" resultType="com.pamher.waterquality.pojo.Device" parameterType="Integer">
        SELECT * FROM devices
    </select>

    <!-- 查询设备信息 -->
    <select id="findDeviceById" resultType="Device" parameterType="Integer">
        SELECT * FROM devices WHERE device_id = #{deviceId}
    </select>

    <!-- 获取设备的最新数据 -->
    <select id="findLatestDeviceData" resultType="com.pamher.waterquality.pojo.DeviceData">
        SELECT * FROM device_data WHERE device_id = #{deviceId} ORDER BY timestamp DESC LIMIT 1
    </select>

    <!-- 获取设备的历史数据 -->

    <select id="findHistoricalDeviceData" resultType="com.pamher.waterquality.pojo.DeviceData">
        SELECT * FROM device_data WHERE device_id = #{deviceId} ORDER BY timestamp DESC
    </select>

    <!-- 保存设备信息 -->
    <insert id="saveDevice" parameterType="com.pamher.waterquality.pojo.Device">
        INSERT INTO devices (device_name, device_quantity, device_image)
        VALUES (#{deviceName}, #{deviceQuantity}, #{deviceImage})
    </insert>
    <!-- 更新设备信息-->
    <update id="updateDevice" parameterType="com.pamher.waterquality.pojo.Device">
        UPDATE devices
        SET device_name = #{deviceName},
            device_quantity = #{deviceQuantity},
            device_image = #{deviceImage}
        WHERE device_id = #{deviceId}
    </update>


    <!-- 删除设备 -->
    <delete id="deleteDevice" parameterType="Integer">
        DELETE FROM devices WHERE device_id = #{deviceId}
    </delete>

</mapper>
